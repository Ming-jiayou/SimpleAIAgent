ç®€ä½“ä¸­æ–‡|[English](./README.md) 

# Simple AI Agent

## åŸºäºC# Semantic Kernel ä¸ WPFæ„å»ºçš„ä¸€æ¬¾AI Agentæ¢ç´¢åº”ç”¨âœ¨

SimpleAIAgentæ˜¯åŸºäºC# Semantic Kernel ä¸ WPFæ„å»ºçš„ä¸€æ¬¾AI Agentæ¢ç´¢åº”ç”¨ã€‚ä¸»è¦ç”¨äºä½¿ç”¨å›½äº§å¤§è¯­è¨€æ¨¡å‹æˆ–å¼€æºå¤§è¯­è¨€æ¨¡å‹æ„å»ºAI Agentåº”ç”¨çš„æ¢ç´¢å­¦ä¹ ï¼Œå¸Œæœ›èƒ½å¤Ÿå¸®åŠ©åˆ°æ„Ÿå…´è¶£çš„æœ‹å‹ã€‚

æ¥ä¸‹æ¥æˆ‘æƒ³åˆ†äº«ä¸€ä¸‹æˆ‘çš„AI Agentåº”ç”¨å®è·µã€‚

## ç¿»è¯‘æ–‡æœ¬å¹¶å°†æ–‡æœ¬å­˜å…¥æ–‡ä»¶

ç¬¬ä¸€ä¸ªä¾‹å­æ˜¯ç¿»è¯‘æ–‡æœ¬ï¼Œå¹¶å°†æ–‡æœ¬å­˜å…¥æŒ‡å®šçš„æ–‡ä»¶ã€‚

è¾“å…¥å¦‚ä¸‹å†…å®¹ï¼š

![image-20240925113714519](https://mingupupup.oss-cn-wuhan-lr.aliyuncs.com/imgs/image-20240925113714519.png)

**æ‰§è¡Œè¿‡ç¨‹**

ç¬¬ä¸€æ­¥ï¼ŒLLMåˆ¤æ–­åº”è¯¥è°ƒç”¨çš„å‡½æ•°ä¸å‚æ•°å¦‚ä¸‹ï¼š

![image-20240925113837225](https://mingupupup.oss-cn-wuhan-lr.aliyuncs.com/imgs/image-20240925113837225.png)

ç¬¬äºŒæ­¥ï¼ŒLLMå¸®æˆ‘ä»¬è°ƒç”¨è¿™ä¸ªå‡½æ•°ï¼Œå¹¶è¿”å›ç»“æœï¼š

![image-20240925113939862](https://mingupupup.oss-cn-wuhan-lr.aliyuncs.com/imgs/image-20240925113939862.png)

ç¬¬ä¸‰æ­¥ï¼ŒLLMå†æ¬¡åˆ¤æ–­éœ€è¦è°ƒç”¨çš„å‡½æ•°ä¸å‚æ•°ï¼š

![image-20240925114202861](https://mingupupup.oss-cn-wuhan-lr.aliyuncs.com/imgs/image-20240925114202861.png)

ç¬¬å››æ­¥ï¼ŒLLMè°ƒç”¨è¿™ä¸ªå‡½æ•°ï¼Œå¹¶è¿”å›å‡½æ•°è¿”å›å€¼ï¼š

![image-20240925114250823](https://mingupupup.oss-cn-wuhan-lr.aliyuncs.com/imgs/image-20240925114250823.png)

ç¬¬äº”æ­¥ï¼ŒLLMåˆ¤æ–­ä»»åŠ¡å·²ç»å®Œæˆï¼Œè°ƒç”¨ç»“æŸå‡½æ•°ï¼š

![image-20240925114350284](https://mingupupup.oss-cn-wuhan-lr.aliyuncs.com/imgs/image-20240925114350284.png)

ç¬¬å…­æ­¥ï¼Œè¿”å›æœ€ç»ˆçš„å›åº”ï¼š

![image-20240925114503461](https://mingupupup.oss-cn-wuhan-lr.aliyuncs.com/imgs/image-20240925114503461.png)

**æŸ¥çœ‹ç»“æœ**

![image-20240925114554332](https://mingupupup.oss-cn-wuhan-lr.aliyuncs.com/imgs/image-20240925114554332.png)

ä¼šå‘ç°æ¡Œé¢å¤šäº†ä¸€ä¸ªæ–‡ä»¶ï¼Œæ‰“å¼€å¦‚ä¸‹æ‰€ç¤ºï¼š

![image-20240925114623548](https://mingupupup.oss-cn-wuhan-lr.aliyuncs.com/imgs/image-20240925114623548.png)

ä»¥ä¸ŠAI Agentåº”ç”¨ä½¿ç”¨glm-4-flashå³å¯å®ç°ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥å°è¯•å…¶ä»–æ¨¡å‹ï¼Œæ¨¡å‹è¶Šå¼ºï¼ŒæˆåŠŸæ¦‚ç‡è¶Šé«˜ã€‚

## å®ç°æ–‡ä»¶åˆ°æ–‡ä»¶çš„ç¿»è¯‘

è¾“å…¥ï¼š

![image-20240925114853823](https://mingupupup.oss-cn-wuhan-lr.aliyuncs.com/imgs/image-20240925114853823.png)

æ–‡ä»¶1.txtçš„å†…å®¹å¦‚ä¸‹ï¼š

![image-20240925115006964](https://mingupupup.oss-cn-wuhan-lr.aliyuncs.com/imgs/image-20240925115006964.png)

æ˜¯ä¸€æ®µå…³äºWPFçš„ä¸­æ–‡æè¿°ï¼Œç°åœ¨æˆ‘æƒ³è®©LLMå¸®æˆ‘ç¿»è¯‘æˆè‹±æ–‡ä¹‹åå†ä¿å­˜åˆ°å¦ä¸€ä¸ªæ–‡ä»¶ã€‚

åŒæ ·è¿˜æ˜¯ä½¿ç”¨å…è´¹çš„glm-4-flash

**æ‰§è¡Œè¿‡ç¨‹**

ç¬¬ä¸€æ­¥ï¼ŒLLMåˆ¤æ–­åº”è¯¥è°ƒç”¨çš„å‡½æ•°ä¸å‚æ•°å¦‚ä¸‹ï¼š

![image-20240925115631597](https://mingupupup.oss-cn-wuhan-lr.aliyuncs.com/imgs/image-20240925115631597.png)

ç¬¬äºŒæ­¥ï¼ŒLLMå¸®æˆ‘ä»¬è°ƒç”¨è¿™ä¸ªå‡½æ•°ï¼Œå¹¶è¿”å›ç»“æœï¼š

![image-20240925120033177](https://mingupupup.oss-cn-wuhan-lr.aliyuncs.com/imgs/image-20240925120033177.png)

ç¬¬ä¸‰æ­¥ï¼ŒLLMåˆ¤æ–­ä»»åŠ¡å·²ç»å®Œæˆï¼Œè°ƒç”¨ç»“æŸå‡½æ•°ï¼š

![image-20240925115856804](https://mingupupup.oss-cn-wuhan-lr.aliyuncs.com/imgs/image-20240925115856804.png)

ç¬¬å››æ­¥ï¼Œè¿”å›æœ€ç»ˆçš„å›åº”ï¼š

![image-20240925115922792](https://mingupupup.oss-cn-wuhan-lr.aliyuncs.com/imgs/image-20240925115922792.png)

**æŸ¥çœ‹ç»“æœ**

![image-20240925120115600](https://mingupupup.oss-cn-wuhan-lr.aliyuncs.com/imgs/image-20240925120115600.png)

![image-20240925120135716](https://mingupupup.oss-cn-wuhan-lr.aliyuncs.com/imgs/image-20240925120135716.png)

## å®ç°è¦ç‚¹

å¤§å®¶å¯èƒ½ä¼šæ³¨æ„åˆ°å®ç°çš„è¦ç‚¹å…¶å®å°±æ˜¯è¦è®©LLMè‡ªåŠ¨è°ƒç”¨å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯å®ç°è‡ªåŠ¨å‡½æ•°è°ƒç”¨çš„åŠŸèƒ½ã€‚

ä¹‹åè¦åšçš„å°±æ˜¯æ ¹æ®ä½ æƒ³è®©LLMè‡ªåŠ¨åšçš„äº‹å»å†™æ’ä»¶ï¼Œç„¶åå¯¼å…¥è¿™ä¸ªæ’ä»¶ç½¢äº†ã€‚

æ’ä»¶ä¸­å‡½æ•°æœ€å¥½ä¸è¦å¤ªå¤šï¼Œå¤ªå¤šæ¨¡å‹èƒ½åŠ›å¼±çš„å°±ä¼šä¹±è°ƒç”¨ã€‚æ ¹æ®ä½ çš„éœ€æ±‚ï¼Œå®ç°ä¸åŒäººç‰©å¯¼å…¥ä¸åŒçš„æ’ä»¶æ¯”è¾ƒå¥½ã€‚

æ’ä»¶å¯ä»¥è¿™æ ·å†™ï¼Œä»¥ä¸Šé¢çš„ç¿»è¯‘æ’ä»¶ä¸ºä¾‹ï¼š

```csharp
#pragma warning disable SKEXP0050
    internal class TranslationFunctions
    {
        private readonly Kernel _kernel;
        public TranslationFunctions()
        {
            var handler = new OpenAIHttpClientHandler();
            var builder = Kernel.CreateBuilder()
            .AddOpenAIChatCompletion(
               modelId: ChatAIOption.ChatModel,
               apiKey: ChatAIOption.Key,
               httpClient: new HttpClient(handler));
            _kernel = builder.Build();
        }
        [KernelFunction, Description("é€‰æ‹©ç”¨æˆ·æƒ³è¦çš„è¯­è¨€ç¿»è¯‘æ–‡æœ¬")]
        public async Task<string> TranslateText(
            [Description("è¦ç¿»è¯‘çš„æ–‡æœ¬")] string text,
            [Description("è¦ç¿»è¯‘æˆçš„è¯­è¨€ï¼Œä»'ä¸­æ–‡'ã€'è‹±æ–‡'ä¸­é€‰ä¸€ä¸ª")] string language
 )
        {
            string skPrompt = """
                            {{$input}}

                            å°†ä¸Šé¢çš„æ–‡æœ¬ç¿»è¯‘æˆ{{$language}}ï¼Œæ— éœ€ä»»ä½•å…¶ä»–å†…å®¹
                            """;
            var result = await _kernel.InvokePromptAsync(skPrompt, new() { ["input"] = text, ["language"] = language });
            var str = result.ToString();
            return str;
        }

        [KernelFunction, Description("å®ç°æ–‡ä»¶åˆ°æ–‡ä»¶çš„ç¿»è¯‘")]
        public async Task<string> TranslateTextFileToFile(
           [Description("è¦ç¿»è¯‘çš„æ–‡ä»¶è·¯å¾„")] string path1,
           [Description("ä¿å­˜ç¿»è¯‘ç»“æœçš„æ–‡ä»¶è·¯å¾„")] string path2,
           [Description("è¦ç¿»è¯‘æˆçš„è¯­è¨€ï¼Œä»'ä¸­æ–‡'ã€'è‹±æ–‡'ä¸­é€‰ä¸€ä¸ª")] string language
)
        {
            string fileContent = File.ReadAllText(path1);
            var lines = TextChunker.SplitPlainTextLines(fileContent,100);
            var paragraphs = TextChunker.SplitPlainTextParagraphs(lines, 1000);
            string result = "";
            string skPrompt = """
                            {{$input}}

                            å°†ä¸Šé¢çš„æ–‡æœ¬ç¿»è¯‘æˆ{{$language}}ï¼Œæ— éœ€ä»»ä½•å…¶ä»–å†…å®¹
                            """;
            foreach (var paragraph in paragraphs)
            {
                var result1 = await _kernel.InvokePromptAsync(skPrompt, new() { ["input"] = paragraph, ["language"] = language });
                result += result1.ToString() + "\r\n";
            }        
           
            var str = result.ToString();

            // ä½¿ç”¨ StreamWriter å°†æ–‡æœ¬å†™å…¥æ–‡ä»¶
            using (StreamWriter writer = new StreamWriter(path2, true))
            {
                writer.WriteLine(str);
            }

            string message = $"å·²æˆåŠŸå®ç°æ–‡ä»¶{path1}åˆ°æ–‡ä»¶{path2}çš„ç¿»è¯‘";
            return message;
        }

        [KernelFunction, Description("å°†æ–‡æœ¬ä¿å­˜åˆ°æ–‡ä»¶")]
        public string SaveTextToFile(
           [Description("è¦ä¿å­˜çš„æ–‡æœ¬")] string text,
           [Description("è¦ä¿å­˜åˆ°çš„æ–‡ä»¶è·¯å¾„")] string filePath
)
        {
            // ä½¿ç”¨ StreamWriter å°†æ–‡æœ¬å†™å…¥æ–‡ä»¶
            using (StreamWriter writer = new StreamWriter(filePath, true))
            {
                writer.WriteLine(text);
            }
            return "å·²æˆåŠŸå†™å…¥æ–‡ä»¶";
        }

        [KernelFunction, Description("ä»æ–‡ä»¶ä¸­è¯»å–æ–‡æœ¬")]
        public string GetTextFromFile(
           [Description("è¦è¯»å–çš„æ–‡ä»¶è·¯å¾„")] string filePath
)
        {
            string fileContent = File.ReadAllText(filePath);
            return fileContent;
        }

    }
```

å°±æ˜¯åŠ ä¸Šäº†ä¸€äº›æè¿°ç”¨äºå¸®åŠ©LLMç†è§£å‡½æ•°çš„ç”¨é€”ç½¢äº†ï¼Œç›¸ä¿¡å¯¹ç¨‹åºå‘˜æœ‹å‹æ¥è¯´ä¸æ˜¯ä»€ä¹ˆé—®é¢˜ï¼Œç°åœ¨å°±å¯ä»¥åŠ¨æ‰‹æ„å»ºè‡ªå·±çš„AI Agentåº”ç”¨äº†ã€‚

å¸Œæœ›è¿™æ¬¡çš„åˆ†äº«å¯¹ä½¿ç”¨LLMæ„å»ºAI Agentåº”ç”¨æ„Ÿå…´è¶£çš„æœ‹å‹æœ‰æ‰€å¸®åŠ©ã€‚

å¯¹è¿™ä¸ªåº”ç”¨æ„Ÿå…´è¶£çš„æœ‹å‹ï¼Œæ‹‰ä¸€ä¸‹ä»£ç ï¼Œå°†appsettings.example.jsonæ”¹ä¸ºappsettings.jsonï¼Œå¡«å…¥ä½ çš„API Keyä¸æ¨¡å‹åæˆ–è€…ä½¿ç”¨Ollmaå¡«å…¥åœ°å€ï¼Œå¡«å…¥æ¨¡å‹åå³å¯å¿«é€Ÿä½“éªŒã€‚

GitHubåœ°å€ï¼šhttps://github.com/Ming-jiayou/SimpleAIAgent

## å¿«é€Ÿå¼€å§‹ğŸš€

GitHubåœ°å€ï¼šhttps://github.com/Ming-jiayou/SimpleTranslationAIAgent

æ³¨æ„åˆ°è¿™é‡Œæœ‰ä¸ªReleasesï¼š

![image-20240831114112502](https://mingupupup.oss-cn-wuhan-lr.aliyuncs.com/imgs/image-20240831114112502.png)

ç‚¹å‡»ï¼Œæœ‰ä¸¤ä¸ªå‹ç¼©åŒ…ï¼š

![image-20240831114150976](https://mingupupup.oss-cn-wuhan-lr.aliyuncs.com/imgs/image-20240831114150976.png)

ä¸€ä¸ªä¾èµ–.net8.0-windowsæ¡†æ¶ï¼Œä¸€ä¸ªç‹¬ç«‹ã€‚

å®‰è£…äº†.net8.0-windowsæ¡†æ¶çš„å°±å¯ä»¥é€‰ä½“ç§¯å°çš„é‚£ä¸ªï¼Œæˆ‘å·²ç»å®‰è£…äº†.net8.0-windowsæ¡†æ¶å°±é€‰æ‹©ä½“ç§¯å°çš„é‚£ä¸€ä¸ªï¼Œç‚¹å‡»å°±åœ¨ä¸‹è½½äº†ï¼Œä¸‹è½½ä¹‹åè§£å‹ç¼©ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

![image-20240831114515700](https://mingupupup.oss-cn-wuhan-lr.aliyuncs.com/imgs/image-20240831114515700.png)

ç°åœ¨åªè¦æ‰“å¼€appsettingså¡«å…¥ä½ çš„API KEYå³å¯ä½¿ç”¨ï¼Œéå¸¸ç®€å•ï¼ï¼

æ‰“å¼€appsettings.jsonæ–‡ä»¶å¦‚ä¸‹æ‰€ç¤ºï¼š

![image-20240831114609377](https://mingupupup.oss-cn-wuhan-lr.aliyuncs.com/imgs/image-20240831114609377.png)

å¡«å…¥ä¹‹åï¼Œç‚¹å‡»SimpleTranslationAIAgent.exeå³å¯è¿è¡Œï¼š

![image-20240831114749577](https://mingupupup.oss-cn-wuhan-lr.aliyuncs.com/imgs/image-20240831114749577.png)

æµ‹è¯•æ˜¯å¦é…ç½®æˆåŠŸï¼š

![](https://mingupupup.oss-cn-wuhan-lr.aliyuncs.com/imgs/image-20240831114836888.png)

é…ç½®å·²ç»æˆåŠŸï¼Œæµ‹è¯•Function Callingæ˜¯å¦æ­£å¸¸ï¼š

![image-20240831114920726](https://mingupupup.oss-cn-wuhan-lr.aliyuncs.com/imgs/image-20240831114920726.png)

Function Callingæ­£å¸¸ï¼Œç°åœ¨å°±å¯ä»¥å¼€å§‹ä½¿ç”¨Translation AI Agentå•¦ï¼ï¼

## æºç æ„å»ºæŒ‡å—ğŸš€

git cloneåˆ°æœ¬åœ°åï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

![image-20240830160422435](https://mingupupup.oss-cn-wuhan-lr.aliyuncs.com/imgs/image-20240830160422435.png)

æ‰“å¼€appsettings.example.jsonæ–‡ä»¶ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

![image-20240830160550389](https://mingupupup.oss-cn-wuhan-lr.aliyuncs.com/imgs/image-20240830160550389.png)

æ™ºè°±AI glm-4-flashå…è´¹äº†ï¼Œä»¥è¿™ä¸ªLLMä¸ºä¾‹ï¼Œå¡«å…¥API KEYä¹‹åï¼Œå°†è¯¥æ–‡ä»¶åå­—æ”¹ä¸ºappsettings.jsonæˆ–è€…æ–°å»ºä¸€ä¸ªappsettings.jsonï¼Œå°†æ–‡ä»¶å†…å®¹å¤åˆ¶è¿›å»å³å¯ï¼š

![image-20240830162839622](https://mingupupup.oss-cn-wuhan-lr.aliyuncs.com/imgs/image-20240830162839622.png)

IDEï¼švs2022

.netç‰ˆæœ¬ï¼š.net 8

æ‰“å¼€è§£å†³æ–¹æ¡ˆï¼š

![image-20240830162920242](https://mingupupup.oss-cn-wuhan-lr.aliyuncs.com/imgs/image-20240830162920242.png)

è¿è¡ŒæŠ¥é”™ï¼š

![image-20240830163038688](https://mingupupup.oss-cn-wuhan-lr.aliyuncs.com/imgs/image-20240830163038688.png)

å³é”®sppsettings.jsonæ–‡ä»¶ï¼Œç‚¹å‡»å±æ€§ï¼Œæ”¹ä¸ºåµŒå…¥çš„èµ„æºï¼š

![image-20240830163211284](https://mingupupup.oss-cn-wuhan-lr.aliyuncs.com/imgs/image-20240830163211284.png)

å†æ¬¡è¿è¡Œï¼Œé€šè¿‡å¯¹è¯éªŒè¯æ˜¯å¦é…ç½®æˆåŠŸï¼š

![image-20240830164734788](https://mingupupup.oss-cn-wuhan-lr.aliyuncs.com/imgs/image-20240830164734788.png)

é…ç½®å·²ç»æˆåŠŸï¼Œæµ‹è¯•Function Callingæ˜¯å¦æ­£å¸¸ï¼š

![image-20240830164818771](https://mingupupup.oss-cn-wuhan-lr.aliyuncs.com/imgs/image-20240830164818771.png)

Function Callingæ­£å¸¸ï¼Œç°åœ¨å°±å¯ä»¥å¼€å§‹ä½¿ç”¨Simple AI Agentå•¦ï¼ï¼
